library(tidyverse)
library(stringr)
library(zoo)
dados <- read.csv2("D:/Users/Mathews/Documents/GIAPS_Jupyter/dados_novos/SISAB.csv", encoding = 'UTF-8', skip = 10, dec = ',')
dados$indicador_escrito <- c()
View(dados)
dados$indicador_escrito <- c()
View(dados)
dados$indicador_escrito <- NA
View(dados)
dados$indicador_escrito[str_detect(string = dados$Uf, pattern = 'Indicador')]
dados$uf[str_detect(string = dados$Uf, pattern = 'Indicador')]
dados$uf[str_detect(string = dados$Uf, pattern = 'Indicador')]
str_detect(string = dados$Uf, pattern = 'Indicador')
dados$IBGE[str_detect(string = dados$Uf, pattern = 'Indicador')]
dados$Uf[str_detect(string = dados$Uf, pattern = 'Indicador')]
dados$Uf[str_detect(string = dados$Uf, pattern = 'Indicador')]
dados$indicador_escrito[str_detect(string = dados$Uf, pattern = 'Indicador')] <- dados$Uf[str_detect(string = dados$Uf, pattern = 'Indicador')]
dados$indicador_escrito[str_detect(string = dados$Uf, pattern = 'Indicador')]
dados$indicador_escrito %>% unique()
View(dados)
dados <- read.csv2("D:/Users/Mathews/Documents/GIAPS_Jupyter/dados_novos/SISAB.csv", encoding = 'UTF-8', skip = 10, dec = ',',na.strings = '')
View(dados)
dados$indicador_escrito <- NA
dados$indicador_escrito[str_detect(string = dados$Uf, pattern = 'Indicador')] <- dados$Uf[str_detect(string = dados$Uf, pattern = 'Indicador')]
dados$indicador_escrito[str_detect(string = dados$Uf, pattern = 'Indicador')]
dados$Uf[str_detect(string = dados$Uf, pattern = 'Indicador')]
dados$Uf[str_detect(string = dados$Uf, pattern = 'Indicador')]
dados$dados$Uf[str_detect(string = dados$Uf, pattern = 'Indicador')] %>% unique()
dados$dados$Uf[str_detect(string = dados$Uf, pattern = 'Indicador')] %>% unique()
dados$dados$Uf[str_detect(string = dados$Uf, pattern = 'Indicador')]
str_detect(string = dados$Uf, pattern = 'Indicador')
dados$dados$Uf[str_detect(string = dados$Uf, pattern = 'Indicador')]
dados$Uf[str_detect(string = dados$Uf, pattern = 'Indicador')]
dados$Uf[str_detect(string = dados$Uf, pattern = 'Indicador')] %>% unique()
dados$Uf[str_detect(string = dados$Uf, pattern = 'Indicador')]
str_detect(string = dados$Uf, pattern = 'Indicador')
dados$Uf[str_detect(string = dados$Uf, pattern = 'Indicador')]
dados$IBGE[str_detect(string = dados$Uf, pattern = 'Indicador')]
dados$Uf[str_detect(string = dados$Uf, pattern = 'Indicador')]
dados <- read.csv2("D:/Users/Mathews/Documents/GIAPS_Jupyter/dados_novos/SISAB.csv", encoding = 'UTF-8', skip = 10, dec = ',')
dados$indicador_escrito <- NA
dados$indicador_escrito[str_detect(string = dados$Uf, pattern = 'Indicador')] <- dados$Uf[str_detect(string = dados$Uf, pattern = 'Indicador')]
dados$Uf[str_detect(string = dados$Uf, pattern = 'Indicador')]
dados$indicador_escrito[str_detect(string = dados$Uf, pattern = 'Indicador')]
dados <- read.csv2("D:/Users/Mathews/Documents/GIAPS_Jupyter/dados_novos/SISAB.csv", encoding = 'UTF-8', skip = 10, dec = ',')
dados$indicador_escrito <- NA
dados$indicador_escrito[str_detect(string = dados$Uf, pattern = 'Indicador')] <- dados$Uf[str_detect(string = dados$Uf, pattern = 'Indicador')]
dados$Uf[str_detect(string = dados$Uf, pattern = 'Indicador')] %>% unique()
View(dados)
dados <- read.csv2("D:/Users/Mathews/Documents/GIAPS_Jupyter/dados_novos/SISAB.csv", encoding = 'UTF-8', dec = ',')
View(dados)
dados <- read.csv2("D:/Users/Mathews/Documents/GIAPS_Jupyter/dados_novos/SISAB.csv", encoding = 'UTF-8', dec = ',', header = F)
View(dados)
dados[11,]
dados <- read.csv2("D:/Users/Mathews/Documents/GIAPS_Jupyter/dados_novos/SISAB.csv", encoding = 'UTF-8', dec = ',', header = F)
dados$indicador_escrito <- NA
dados$indicador_escrito[str_detect(string = dados$V1, pattern = 'Indicador')]
dados$V1[str_detect(string = dados$V1, pattern = 'Indicador')]
dados$indicador_escrito[str_detect(string = dados$V1, pattern = 'Indicador')] <- dados$V1[str_detect(string = dados$V1, pattern = 'Indicador')]
dados$V1[str_detect(string = dados$V1, pattern = 'Indicador')] %>% unique()
dados %>% filter(Negate(indicador_escrito%in%c("Painel Indicador","Pontuação dos Indicadores de Pagamento por Desempenho")))
dados %>% filter(Negate(indicador_escrito%in%c("Painel Indicador","Pontuação dos Indicadores de Pagamento por Desempenho")))
dados %>% filter(negate(indicador_escrito%in%c("Painel Indicador","Pontuação dos Indicadores de Pagamento por Desempenho")))
negate(%in%)
Negate(%in%)
`%notin%` <- Negate(`%in%`)
`%notin%` <- Negate(`%in%`)
dados %>% filter(indicador_escrito%notin%c("Painel Indicador","Pontuação dos Indicadores de Pagamento por Desempenho"))
dados <- dados %>% filter(indicador_escrito%notin%c("Painel Indicador","Pontuação dos Indicadores de Pagamento por Desempenho"))
View(dados)
na.locf(dados$indicador_escrito)
dados$indicador_escrito %>% unique()
dados$indicador_escrito <- na.locf(dados$indicador_escrito)
dados <- dados[-c(1:6),]
dados$indicador_escrito <- na.locf(dados$indicador_escrito)
View(dados)
dados[1,2]
View(dados)
dados$indicador_escrito %>% unique()
dados$V7
dados$V7[str_detect(string = dados$V7, pattern = '%')]
dados$tempo <- NA
dados$tempo[str_detect(string = dados$V7, pattern = '%')] <- dados$V7[str_detect(string = dados$V7, pattern = '%')]
dados$tempo
View(dados)
dados$tempo
dados$tempo[-c(1:3)]
dados$tempo[-c(1:3)] <- na.locf(dados$tempo[-c(1:3)])
View(dados)
dados <- dados %>% filter(V2!='')
View(dados)
dados$V1 %>% unique()
dados[1,]
dados[1,1]
dados[1,]
names(dados)
names(dados) <- c('uf','ibge','nome_mun','numerador','denominador_informado',
'denominador_estimado','indicador_calculado','indicador')
dados <- dados %>% filter(uf!='Uf')
dados <- dados %>% filter(uf!='Uf')
library(tidyverse)
library(stringr)
library(zoo)
`%notin%` <- Negate(`%in%`)
dados <- read.csv2("D:/Users/Mathews/Documents/GIAPS_Jupyter/dados_novos/SISAB.csv", encoding = 'UTF-8', dec = ',', header = F)
dados$indicador_escrito <- NA
dados$indicador_escrito[str_detect(string = dados$V1, pattern = 'Indicador')] <- dados$V1[str_detect(string = dados$V1, pattern = 'Indicador')]
dados$V1[str_detect(string = dados$V1, pattern = 'Indicador')] %>% unique()
dados <- dados %>% filter(indicador_escrito%notin%c("Painel Indicador","Pontuação dos Indicadores de Pagamento por Desempenho"))
dados <- dados[-c(1:6),]
dados$indicador_escrito <- na.locf(dados$indicador_escrito)
###########################
dados$tempo <- NA
dados$tempo[str_detect(string = dados$V7, pattern = '%')] <- dados$V7[str_detect(string = dados$V7, pattern = '%')]
dados$tempo[-c(1:3)] <- na.locf(dados$tempo[-c(1:3)])
#######
dados <- dados %>% filter(V2!='')
names(dados)[1:8] <- c('uf','ibge','nome_mun','numerador','denominador_informado',
'denominador_estimado','indicador_calculado','indicador')
dados <- dados %>% filter(uf!='Uf')
View(dados)
dados$uf %>% unique()
dados$ibge %>% unique()
dados$indicador_escrito %>% unique()
View(dados)
regiao_saude <- read.csv(file='D:/Users/Mathews/Downloads/tableExport2.csv', encoding = 'UTF-8')
View(regiao_saude)
############# Criação dos fatores dos indicadores ################
unique(dados$indicador_escrito)
dados$indicador <- factor(dados$indicador_escrito,
levels=diabéticos,
labels=c('GEPRE','GEDST','GEODO','CITO','POLI','HIPER','DIA'))
dados$indicador <- factor(dados$indicador_escrito,
levels=unique(dados$indicador_escrito),
labels=c('GEPRE','GEDST','GEODO','CITO','POLI','HIPER','DIA'))
View(dados)
regiao_saude <- read.csv(file='D:/Users/Mathews/Downloads/tableExport2.csv', encoding = 'UTF-8')
names(regiao_saude)
names(regiao_saude)[2] <-'uf'
dados$ibge %>% str_length()
dados$ibge %>% str_length() %>% mean()
regiao_saude$Cód.IBGE %>% str_length() %>% mean()
names(regiao_saude)[4:6]
names(regiao_saude)[4:6] <- c('ibge','cod_reg_saude','reg_saude')
Dados_MS <- left_join(Dados_MS %>% select(-c(indicador_escrito)), regiao_saude %>% select(IBGE,COD_REG_SAUDE,REG_SAUDE))
Dados_MS <- left_join(dados %>% select(-c(indicador_escrito)), regiao_saude %>% select(IBGE,COD_REG_SAUDE,REG_SAUDE))
Dados_MS <- left_join(dados %>% select(-c(indicador_escrito)), regiao_saude %>% select(ibge,cod_reg_saude,reg_saude))
Dados_MS <- left_join(dados %>% select(-c(indicador_escrito)), regiao_saude %>% select(ibge,cod_reg_saude,reg_saude))
class(regiao_saude$ibge)
dados$ibge <- as.integer(dados$ibge)
Dados_MS <- left_join(dados %>% select(-c(indicador_escrito)), regiao_saude %>% select(ibge,cod_reg_saude,reg_saude))
View(Dados_MS)
Dados_Mun <- left_join(dados %>% select(-c(indicador_escrito)), regiao_saude %>% select(ibge,cod_reg_saude,reg_saude))
Dados_Mun$denominador_utilizado <- c()
for(j in 1:nrow(Dados_Mun)){
Dados_Mun$denominador_utilizado[j] <- max(Dados_Mun$denominador_informado[j],
Dados_Mun$denominador_estimado[j])
}
View(Dados_Mun)
Dados_Mun$indicador_calculado
Dados_Mun$indicador_calculado %>% summary()
Dados_Mun$indicador_calculado <- as.numeric(Dados_Mun$indicador_calculado)
summary(Dados_Mun$indicador_calculado)
Dados_Mun$indicador_calculado <- Dados_Mun$indicador_calculado/100
Dados_Mun$ano <- Dados_Mun$tempo
Dados_Mun$ano
str_sub(Dados_Mun$ano,1,4)
Dados_Mun$tempo
dados$quadrimestre <- str_sub(Dados_Mun$tempo,5,6)
dados$quadrimestre
dados$quadrimestre <- str_sub(Dados_Mun$tempo,6,7)
dados$quadrimestre
Dados_Mun$quadrimestre <- str_sub(Dados_Mun$tempo,6,7)
Dados_Mun$quadrimestre
Dados_Mun$tempo <- paste0(Dados_Mun$ano, Dados_Mun$quadrimestre)
Dados_Mun$tempo
Dados_Mun$tempo <- paste0(Dados_Mun$ano, Dados_Mun$quadrimestre)
Dados_Mun$tempo
Dados_Mun$ano
Dados_Mun$tempo
paste0(Dados_Mun$ano, Dados_Mun$quadrimestre)
Dados_Mun$ano
Dados_Mun$ano <- str_sub(Dados_Mun$ano,1,4)
Dados_Mun$ano
Dados_Mun$ano <- str_sub(Dados_Mun$tempo,1,4)
Dados_Mun$quadrimestre <- str_sub(Dados_Mun$tempo,6,7)
paste0(Dados_Mun$ano, Dados_Mun$quadrimestre)
Dados_Mun$ano <- str_sub(Dados_Mun$tempo,1,4)
Dados_Mun$ano
Dados_Mun$quadrimestre <- str_sub(Dados_Mun$tempo,6,7)
Dados_Mun$quadrimestre
Dados_Mun$tempo <- paste0(Dados_Mun$ano, Dados_Mun$quadrimestre)
Dados_Mun$tempo
Dados_Mun$tempo
Dados_Mun$quadrimestre
Dados_Mun %>% select(c('uf','ibge','nome_mun','numerador','denominador_informado',
'denominador_estimado','indicador_calculado','indicador',
'tempo','denominador_utilizado','cod_reg_saude','reg_saude',
'ano','quadrimestre'))
Dados_Mun <- Dados_Mun %>% select(c('uf','ibge','nome_mun','numerador','denominador_informado',
'denominador_estimado','indicador_calculado','indicador',
'tempo','denominador_utilizado','cod_reg_saude','reg_saude',
'ano','quadrimestre'))
getwd()
View(Dados_Mun)
save(Dados_Mun, file='D:/Users/Mathews/Documents/Git/semana_extensao_est/dados muncipio/Dados_Mun.rdata')
write.csv(Dados_Mun, file = 'D:/Users/Mathews/Documents/Git/semana_extensao_est/dados muncipio/Dados_Mun.csv', sep=',', row.names = F)
Dados_Mun %>% filter(ano!='2021')
Dados_Mun <- Dados_Mun %>% filter(ano!='2021')
save(Dados_Mun, file='D:/Users/Mathews/Documents/Git/semana_extensao_est/dados muncipio/Dados_Mun.rdata')
write.csv(Dados_Mun, file = 'D:/Users/Mathews/Documents/Git/semana_extensao_est/dados muncipio/Dados_Mun.csv', sep=',', row.names = F)
